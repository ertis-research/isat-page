{{ define "main" }}

{{ $css := resources.Get "css/problematica.css" }}
{{ $heroCss := resources.Get "css/hero.css" }}
{{ $finCss := resources.Get "css/financiacion.css" }}
<link rel="stylesheet" href="{{ $heroCss.RelPermalink }}">
<link rel="stylesheet" href="{{ $css.RelPermalink }}">
<link rel="stylesheet" href="{{ $finCss.RelPermalink }}">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

<!-- Page-specific styles moved to assets/css/financiacion.css -->

<!-- --- 1. CABECERA INSTITUCIONAL (front-matter-driven) --- -->
<section class="relative pt-20 pb-16 bg-white border-b border-gray-200">
	<div class="container mx-auto px-6 max-w-5xl animate-fade-in">
		{{ $hero := index (where .Params.sections "block" "hero") 0 }}
		{{ if $hero }}
			{{ if $hero.content.announcement.text }}
				<span class="inline-block py-1 px-3 rounded-full bg-blue-50 text-blue-800 text-xs font-bold uppercase tracking-wider mb-6 border border-blue-100">{{ $hero.content.announcement.text }}</span>
			{{ end }}
			<h1 class="text-3xl md:text-5xl font-extrabold mb-8 leading-tight text-gray-900">{{ $hero.content.title }} <span class="prob-gradient-text">{{ $hero.content.highlight }}</span></h1>
			<div class="bg-blue-50/50 p-6 rounded-xl border-l-4 border-blue-600 mb-10 text-lg text-gray-700 leading-relaxed">{{ $hero.content.text }}</div>
		{{ end }}

		{{ $logos := index (where .Params.sections "id" "logos") 0 }}
		{{ if $logos }}
		<div class="grid grid-cols-2 md:grid-cols-4 gap-8 items-center justify-items-center mt-12 opacity-90">
			{{ range $logos.content.items }}
				<div class="logo-placeholder flex flex-col items-center text-center gap-2">
					<div class="w-48 h-20 bg-gray-100 border-2 border-dashed border-gray-300 rounded-lg flex items-center justify-center text-gray-300 hover:bg-gray-200 transition-colors">
						{{ if .image }}<img src="{{ .image }}" alt="{{ .label }}" class="max-h-full"/>{{ else }}<i class="fas fa-image text-2xl"></i>{{ end }}
					</div>
					<span class="text-xs text-gray-400 font-semibold uppercase">{{ .label }}</span>
				</div>
			{{ end }}
		</div>
		{{ end }}
	</div>
</section>

{{ $ficha := index (where .Params.sections "id" "ficha_administrativa") 0 }}
{{ if $ficha }}
<section class="py-16 bg-slate-50">
	<div class="container mx-auto px-6 max-w-5xl">
		<h2 class="text-2xl font-bold text-gray-900 mb-8 border-b border-gray-200 pb-2">{{ $ficha.content.title }}</h2>
		<div class="grid md:grid-cols-2 gap-6">
			{{ range $ficha.content.items }}
			<div class="bg-white p-5 rounded-lg shadow-sm border border-gray-100 flex items-start gap-4">
				<div class="w-10 h-10 rounded-lg flex items-center justify-center flex-shrink-0 bg-{{ .bg }} text-{{ .color }}"><i class="fas fa-{{ .icon }}"></i></div>
				<div>
					<h4 class="text-sm font-semibold text-gray-500 uppercase tracking-wider">{{ .label }}</h4>
					<p class="text-lg font-bold text-gray-900">{{ .value }}</p>
				</div>
			</div>
			{{ end }}
		</div>
	</div>
</section>
{{ end }}


{{ $pres := index (where .Params.sections "id" "presupuesto") 0 }}
{{ if $pres }}
<section class="py-20 bg-white">
  <div class="container mx-auto px-6 max-w-6xl">
    <div class="text-center mb-12">
      <h2 class="text-3xl font-bold text-gray-900">{{ $pres.content.title }}</h2>
      <p class="text-gray-600 mt-4 max-w-2xl mx-auto">{{ $pres.content.subtitle }} <span class="font-bold text-blue-700 bg-blue-50 px-2 py-1 rounded">{{ $pres.content.total }}</span></p>
    </div>

    <div class="flex flex-col lg:flex-row items-center justify-center gap-16">
      <div class="relative flex flex-col items-center">
        <div class="donut-chart shadow-lg"></div>
        <div class="absolute inset-0 flex items-center justify-center pointer-events-none">
          <div class="text-center"><span class="block text-sm text-gray-400 font-semibold">{{ $pres.content.total_label }}</span><span class="block text-xl font-bold text-gray-800">{{ $pres.content.total_short }}</span></div>
        </div>
        <p class="mt-6 text-sm text-gray-400 italic text-center">{{ $pres.content.note }}</p>
      </div>

      <div class="w-full max-w-2xl bg-white rounded-xl shadow-lg border border-gray-100 overflow-hidden">
        <table class="w-full text-left border-collapse financiacion-table">
					<thead>
						<tr class="bg-gray-50 text-gray-600 text-sm uppercase tracking-wider border-b border-gray-200"><th class="p-4 font-semibold">{{ $pres.content.headers.concept }}</th><th class="p-4 font-semibold text-right">{{ $pres.content.headers.amount }}</th><th class="p-4 font-semibold text-center w-24">{{ $pres.content.headers.percent }}</th></tr>
					</thead>
          <tbody class="text-gray-700">
            {{ range $pres.content.items }}
            <tr class="border-b border-gray-50 hover:bg-blue-50/30 transition-colors"><td class="p-4 flex items-center gap-3"><span class="w-3 h-3 rounded-full bg-{{ .dot }}"></span><span class="font-medium">{{ .concept }}</span></td><td class="p-4 text-right font-mono font-medium">{{ .amount }}</td><td class="p-4 text-center text-sm text-gray-500">{{ .percent }}</td></tr>
            {{ end }}
          </tbody>
          <tfoot class="bg-gray-100 font-bold text-gray-900 border-t-2 border-gray-200"><tr><td class="p-4">{{ $pres.content.total_label }}</td><td class="p-4 text-right font-mono text-lg">{{ $pres.content.total }}</td><td></td></tr></tfoot>
        </table>
      </div>
    </div>
  </div>
</section>
{{ end }}


{{ $equip := index (where .Params.sections "id" "equipamiento") 0 }}
{{ if $equip }}
<section class="py-16 bg-gradient-to-br from-slate-900 to-blue-900 text-white">
	<div class="container mx-auto px-6 max-w-5xl">
		<h2 class="text-2xl font-bold mb-8 flex items-center gap-3"><i class="fas fa-microchip text-blue-400"></i> {{ $equip.content.title }}</h2>
		<p class="text-blue-100 mb-8 max-w-3xl">{{ $equip.content.subtitle }}</p>
		<div class="grid md:grid-cols-3 gap-6">
			{{ range $equip.content.items }}
			<div class="bg-white/10 backdrop-blur-md p-6 rounded-xl border border-white/10 hover:bg-white/20 transition-all">
				<div class="text-{{ .color }} text-3xl mb-4"><i class="fas fa-{{ .icon }}"></i></div>
				<h3 class="font-bold text-lg mb-2">{{ .name }}</h3>
				<p class="text-sm text-gray-300">{{ .description }}</p>
			</div>
			{{ end }}
		</div>
	</div>
</section>
{{ end }}


{{ end }}
